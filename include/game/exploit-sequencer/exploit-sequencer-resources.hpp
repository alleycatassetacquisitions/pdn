#pragma once

#include "device/drivers/light-interface.hpp"
#include "game/exploit-sequencer/exploit-sequencer.hpp"

/*
 * Exploit Sequencer LED palettes — orange/amber theme (exploit injection).
 */

// Primary palette (4 colors) — used for non-idle animations
const LEDColor exploitSeqColors[4] = {
    LEDColor(255, 140, 0),    // Dark orange
    LEDColor(255, 100, 0),    // Deep orange
    LEDColor(255, 180, 40),   // Amber
    LEDColor(200, 80, 0),     // Burnt orange
};

// Idle palette (8 colors) — used for idle breathing animation
const LEDColor exploitSeqIdleColors[8] = {
    LEDColor(255, 140, 0),    LEDColor(255, 100, 0),
    LEDColor(255, 180, 40),   LEDColor(200, 80, 0),
    LEDColor(255, 140, 0),    LEDColor(255, 100, 0),
    LEDColor(255, 180, 40),   LEDColor(200, 80, 0),
};

// Idle state — orange/amber pulse
const LEDState EXPLOIT_SEQ_IDLE_STATE = [](){
    LEDState state;
    for (int i = 0; i < 9; i++) {
        state.leftLights[i] = LEDState::SingleLEDState(
            exploitSeqIdleColors[i % 8], 65);
        state.rightLights[i] = LEDState::SingleLEDState(
            exploitSeqIdleColors[i % 8], 65);
    }
    return state;
}();

// Gameplay state — chase animation during QTE
const LEDState EXPLOIT_SEQ_GAMEPLAY_STATE = [](){
    LEDState state;
    for (int i = 0; i < 9; i++) {
        state.leftLights[i] = LEDState::SingleLEDState(
            exploitSeqColors[i % 4], 180);
        state.rightLights[i] = LEDState::SingleLEDState(
            exploitSeqColors[i % 4], 180);
    }
    return state;
}();

// Win state — bright amber sweep
const LEDState EXPLOIT_SEQ_WIN_STATE = [](){
    LEDState state;
    for (int i = 0; i < 9; i++) {
        uint8_t g = static_cast<uint8_t>(180 - (i * 15));
        state.leftLights[i] = LEDState::SingleLEDState(LEDColor(255, g, 0), 255);
        state.rightLights[i] = LEDState::SingleLEDState(LEDColor(255, g, 0), 255);
    }
    return state;
}();

// Lose state — red fade
const LEDState EXPLOIT_SEQ_LOSE_STATE = [](){
    LEDState state;
    for (int i = 0; i < 9; i++) {
        uint8_t brightness = static_cast<uint8_t>(255 - (i * 25));
        state.leftLights[i] = LEDState::SingleLEDState(LEDColor(255, 0, 0), brightness);
        state.rightLights[i] = LEDState::SingleLEDState(LEDColor(255, 0, 0), brightness);
    }
    return state;
}();

// Hit flash — green
const LEDState EXPLOIT_SEQ_HIT_STATE = [](){
    LEDState state;
    for (int i = 0; i < 9; i++) {
        state.leftLights[i] = LEDState::SingleLEDState(LEDColor(0, 255, 0), 255);
        state.rightLights[i] = LEDState::SingleLEDState(LEDColor(0, 255, 0), 255);
    }
    return state;
}();

// Miss flash — red
const LEDState EXPLOIT_SEQ_MISS_STATE = [](){
    LEDState state;
    for (int i = 0; i < 9; i++) {
        state.leftLights[i] = LEDState::SingleLEDState(LEDColor(255, 0, 0), 255);
        state.rightLights[i] = LEDState::SingleLEDState(LEDColor(255, 0, 0), 255);
    }
    return state;
}();
